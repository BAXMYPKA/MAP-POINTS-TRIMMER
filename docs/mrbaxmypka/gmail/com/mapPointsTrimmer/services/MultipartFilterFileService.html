<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="ru">
<head>
<!-- Generated by javadoc (14.0.1) on Thu Sep 30 19:47:12 MSK 2021 -->
<title>MultipartFilterFileService</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2021-09-30">
<meta name="description" content="declaration: package: mrbaxmypka.gmail.com.mapPointsTrimmer.services, class: MultipartFilterFileService">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../script-dir/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../../script-dir/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../../script-dir/jquery-3.4.1.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-ui.js"></script>
</head>
<body class="class-declaration">
<script type="text/javascript">var data = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flexBox">
<header role="banner" class="flexHeader">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<div class="navListSearch"><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="skipNav"><a id="skip.navbar.top">
<!--   -->
</a></div>
</nav>
</header>
<div class="flexContent">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">mrbaxmypka.gmail.com.mapPointsTrimmer.services</a></div>
<h1 title="Class MultipartFilterFileService" class="title">Class MultipartFilterFileService</h1>
</div>
<div class="contentContainer">
<div class="inheritance" title="Inheritance Tree">java.lang.Object
<div class="inheritance"><a href="MultipartMainFileService.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.services">mrbaxmypka.gmail.com.mapPointsTrimmer.services.MultipartMainFileService</a>
<div class="inheritance">mrbaxmypka.gmail.com.mapPointsTrimmer.services.MultipartFilterFileService</div>
</div>
</div>
<section class="description">
<hr>
<pre>@Service
public class <span class="typeNameLabel">MultipartFilterFileService</span>
extends <a href="MultipartMainFileService.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.services">MultipartMainFileService</a></pre>
</section>
<section class="summary">
<ul class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<li class="blockList">
<section class="fieldSummary"><a id="field.summary">
<!--   -->
</a>
<h2>Field Summary</h2>
<div class="memberSummary">
<table>
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<thead>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Field</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../xml/KmlHandler.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.xml">KmlHandler</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#kmlHandler">kmlHandler</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li class="blockList">
<section class="constructorSummary"><a id="constructor.summary">
<!--   -->
</a>
<h2>Constructor Summary</h2>
<div class="memberSummary">
<table>
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<thead>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(mrbaxmypka.gmail.com.mapPointsTrimmer.services.FileService,org.springframework.context.MessageSource,mrbaxmypka.gmail.com.mapPointsTrimmer.xml.KmlHandler)">MultipartFilterFileService</a></span>&#8203;(<a href="FileService.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.services">FileService</a>&nbsp;fileService,
org.springframework.context.MessageSource&nbsp;messageSource,
<a href="../xml/KmlHandler.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.xml">KmlHandler</a>&nbsp;kmlHandler)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li class="blockList">
<section class="methodSummary"><a id="method.summary">
<!--   -->
</a>
<h2>Method Summary</h2>
<div class="memberSummary">
<div role="tablist" aria-orientation="horizontal"><button role="tab" aria-selected="true" aria-controls="memberSummary_tabpanel" tabindex="0" onkeydown="switchTab(event)" id="t0" class="activeTableTab">All Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t2" class="tableTab" onclick="show(2);">Instance Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t4" class="tableTab" onclick="show(8);">Concrete Methods</button></div>
<div id="memberSummary_tabpanel" role="tabpanel">
<table aria-labelledby="t0">
<thead>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor" id="i0">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#changeCharset(mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartFilterDto)">changeCharset</a></span>&#8203;(<a href="../entitiesDto/MultipartFilterDto.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto">MultipartFilterDto</a>&nbsp;multipartFilterDto)</code></th>
<td class="colLast">
<div class="block">If UTF8 filenames encoding has thrown an exception, this method
 For RU locale:
 1) Sets primary OEM "IBM866" encoding.
 2) Then tries to use "Windows-1251" encoding if no luck.
 3) Throws an exception with a message for a user if no luck.</div>
</td>
</tr>
<tr class="rowColor" id="i1">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#checkCorrectXmlFilename(java.lang.String,java.util.Locale)">checkCorrectXmlFilename</a></span>&#8203;(java.lang.String&nbsp;xmlFilename,
java.util.Locale&nbsp;locale)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i2">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#checkCorrectZipFilename(java.lang.String,java.util.Locale)">checkCorrectZipFilename</a></span>&#8203;(java.lang.String&nbsp;zipFilename,
java.util.Locale&nbsp;locale)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i3">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#checkNullEmptyFilename(java.lang.String,java.util.Locale)">checkNullEmptyFilename</a></span>&#8203;(java.lang.String&nbsp;filename,
java.util.Locale&nbsp;locale)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i4">
<td class="colFirst"><code>private java.nio.file.Path</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#createTempZip(java.lang.String,mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartFilterDto,java.util.Locale)">createTempZip</a></span>&#8203;(java.lang.String&nbsp;processedXml,
<a href="../entitiesDto/MultipartFilterDto.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto">MultipartFilterDto</a>&nbsp;multipartFilterDto,
java.util.Locale&nbsp;locale)</code></th>
<td class="colLast">
<div class="block">https://stackoverflow.com/a/43836969/11592202
 Relocates all the internal files from a given .kmz or .gpz from a User to the temp directory as a new kmz
 with replacing an old inner .kml or .gpx with the new one.</div>
</td>
</tr>
<tr class="rowColor" id="i5">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#filterTempZip(java.lang.String,mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartFilterDto)">filterTempZip</a></span>&#8203;(java.lang.String&nbsp;processedXml,
<a href="../entitiesDto/MultipartFilterDto.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto">MultipartFilterDto</a>&nbsp;multipartFilterDto)</code></th>
<td class="colLast">
<div class="block">Extracts files from the user's archive, filters them and writes into a new temporary zip in the temp file.</div>
</td>
</tr>
<tr class="altColor" id="i6">
<td class="colFirst"><code>private java.io.InputStream</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getXmlFromKmz(mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartFilterDto,java.util.Locale)">getXmlFromKmz</a></span>&#8203;(<a href="../entitiesDto/MultipartFilterDto.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto">MultipartFilterDto</a>&nbsp;multipartFilterDto,
java.util.Locale&nbsp;locale)</code></th>
<td class="colLast">
<div class="block">1) Looks through all the .kmz
 2) Searches for .xml (.kml) file inside the given .zip (.kml) to return it in the end
 3) Adds all found images files to the instant cache in <code>MultipartMainDto#getImagesNamesFromZip()</code></div>
</td>
</tr>
<tr class="rowColor" id="i7">
<td class="colFirst"><code>private java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getZipFilename(mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartFilterDto)">getZipFilename</a></span>&#8203;(<a href="../entitiesDto/MultipartFilterDto.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto">MultipartFilterDto</a>&nbsp;multipartFilterDto)</code></th>
<td class="colLast">
<div class="block">As some old versions of Edge browser (at least Microsoft EdgeHTML 17 +) attach <code>MultipartFile.getOriginalFilename()</code>
 as the full path to the file (e.g.</div>
</td>
</tr>
<tr class="altColor" id="i8">
<td class="colFirst"><code>private java.nio.file.Path</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#processKmz(mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartFilterDto,java.util.Locale)">processKmz</a></span>&#8203;(<a href="../entitiesDto/MultipartFilterDto.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto">MultipartFilterDto</a>&nbsp;multipartFilterDto,
java.util.Locale&nbsp;locale)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i9">
<td class="colFirst"><code>java.nio.file.Path</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#processMultipartFilterDto(mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartFilterDto)">processMultipartFilterDto</a></span>&#8203;(<a href="../entitiesDto/MultipartFilterDto.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto">MultipartFilterDto</a>&nbsp;multipartFilterDto)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i10">
<td class="colFirst"><code>private java.nio.file.Path</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#processTxt(mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartFilterDto,java.util.Locale)">processTxt</a></span>&#8203;(<a href="../entitiesDto/MultipartFilterDto.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto">MultipartFilterDto</a>&nbsp;multipartFilterDto,
java.util.Locale&nbsp;locale)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="rowColor" id="i11">
<td class="colFirst"><code>private java.nio.file.Path</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#processXml(mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartFilterDto,java.util.Locale)">processXml</a></span>&#8203;(<a href="../entitiesDto/MultipartFilterDto.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto">MultipartFilterDto</a>&nbsp;multipartFilterDto,
java.util.Locale&nbsp;locale)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
<tr class="altColor" id="i12">
<td class="colFirst"><code>private void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#throwZipFilenamesEncodingException(mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartFilterDto)">throwZipFilenamesEncodingException</a></span>&#8203;(<a href="../entitiesDto/MultipartFilterDto.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto">MultipartFilterDto</a>&nbsp;multipartFilterDto)</code></th>
<td class="colLast">&nbsp;</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="inheritedList">
<h3>Methods inherited from class&nbsp;mrbaxmypka.gmail.com.mapPointsTrimmer.services.<a href="MultipartMainFileService.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.services">MultipartMainFileService</a></h3>
<a id="methods.inherited.from.class.mrbaxmypka.gmail.com.mapPointsTrimmer.services.MultipartMainFileService">
<!--   -->
</a><code><a href="MultipartMainFileService.html#addImageNameFromZip(java.util.zip.ZipEntry,mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartDto)">addImageNameFromZip</a>, <a href="MultipartMainFileService.html#deleteTempFile(java.lang.String)">deleteTempFile</a>, <a href="MultipartMainFileService.html#deleteTempFiles()">deleteTempFiles</a>, <a href="MultipartMainFileService.html#processMultipartMainDto(mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartMainDto)">processMultipartMainDto</a></code></div>
<div class="inheritedList">
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a><code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<li class="blockList">
<section class="fieldDetails"><a id="field.detail">
<!--   -->
</a>
<h2>Field Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="kmlHandler">kmlHandler</a></h3>
<div class="memberSignature"><span class="modifiers">private final</span>&nbsp;<span class="returnType"><a href="../xml/KmlHandler.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.xml">KmlHandler</a></span>&nbsp;<span class="memberName">kmlHandler</span></div>
</section>
</li>
</ul>
</section>
</li>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li class="blockList">
<section class="constructorDetails"><a id="constructor.detail">
<!--   -->
</a>
<h2>Constructor Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="&lt;init&gt;(mrbaxmypka.gmail.com.mapPointsTrimmer.services.FileService,org.springframework.context.MessageSource,mrbaxmypka.gmail.com.mapPointsTrimmer.xml.KmlHandler)">MultipartFilterFileService</a></h3>
<div class="memberSignature"><span class="annotations">@Autowired
</span><span class="modifiers">public</span>&nbsp;<span class="memberName">MultipartFilterFileService</span>&#8203;(<span class="arguments"><a href="FileService.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.services">FileService</a>&nbsp;fileService,
org.springframework.context.MessageSource&nbsp;messageSource,
<a href="../xml/KmlHandler.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.xml">KmlHandler</a>&nbsp;kmlHandler)</span></div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li class="blockList">
<section class="methodDetails"><a id="method.detail">
<!--   -->
</a>
<h2>Method Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="processMultipartFilterDto(mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartFilterDto)">processMultipartFilterDto</a></h3>
<div class="memberSignature"><span class="modifiers">public</span>&nbsp;<span class="returnType">java.nio.file.Path</span>&nbsp;<span class="memberName">processMultipartFilterDto</span>&#8203;(<span class="arguments"><a href="../entitiesDto/MultipartFilterDto.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto">MultipartFilterDto</a>&nbsp;multipartFilterDto)</span>
                                             throws <span class="exceptions">java.io.IOException,
javax.xml.parsers.ParserConfigurationException,
org.xml.sax.SAXException,
javax.xml.transform.TransformerException</span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
<dd><code>javax.xml.parsers.ParserConfigurationException</code></dd>
<dd><code>org.xml.sax.SAXException</code></dd>
<dd><code>javax.xml.transform.TransformerException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="processXml(mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartFilterDto,java.util.Locale)">processXml</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">java.nio.file.Path</span>&nbsp;<span class="memberName">processXml</span>&#8203;(<span class="arguments"><a href="../entitiesDto/MultipartFilterDto.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto">MultipartFilterDto</a>&nbsp;multipartFilterDto,
java.util.Locale&nbsp;locale)</span>
                               throws <span class="exceptions">java.io.IOException,
javax.xml.parsers.ParserConfigurationException,
org.xml.sax.SAXException,
javax.xml.transform.TransformerException</span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
<dd><code>javax.xml.parsers.ParserConfigurationException</code></dd>
<dd><code>org.xml.sax.SAXException</code></dd>
<dd><code>javax.xml.transform.TransformerException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="processKmz(mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartFilterDto,java.util.Locale)">processKmz</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">java.nio.file.Path</span>&nbsp;<span class="memberName">processKmz</span>&#8203;(<span class="arguments"><a href="../entitiesDto/MultipartFilterDto.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto">MultipartFilterDto</a>&nbsp;multipartFilterDto,
java.util.Locale&nbsp;locale)</span>
                               throws <span class="exceptions">java.io.IOException,
javax.xml.parsers.ParserConfigurationException,
org.xml.sax.SAXException,
javax.xml.transform.TransformerException</span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
<dd><code>javax.xml.parsers.ParserConfigurationException</code></dd>
<dd><code>org.xml.sax.SAXException</code></dd>
<dd><code>javax.xml.transform.TransformerException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="processTxt(mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartFilterDto,java.util.Locale)">processTxt</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">java.nio.file.Path</span>&nbsp;<span class="memberName">processTxt</span>&#8203;(<span class="arguments"><a href="../entitiesDto/MultipartFilterDto.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto">MultipartFilterDto</a>&nbsp;multipartFilterDto,
java.util.Locale&nbsp;locale)</span>
                               throws <span class="exceptions">java.io.IOException</span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="checkCorrectZipFilename(java.lang.String,java.util.Locale)">checkCorrectZipFilename</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">checkCorrectZipFilename</span>&#8203;(<span class="arguments">java.lang.String&nbsp;zipFilename,
java.util.Locale&nbsp;locale)</span>
                              throws <span class="exceptions">java.lang.IllegalArgumentException</span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="checkCorrectXmlFilename(java.lang.String,java.util.Locale)">checkCorrectXmlFilename</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">checkCorrectXmlFilename</span>&#8203;(<span class="arguments">java.lang.String&nbsp;xmlFilename,
java.util.Locale&nbsp;locale)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="checkNullEmptyFilename(java.lang.String,java.util.Locale)">checkNullEmptyFilename</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">checkNullEmptyFilename</span>&#8203;(<span class="arguments">java.lang.String&nbsp;filename,
java.util.Locale&nbsp;locale)</span>
                             throws <span class="exceptions">java.lang.IllegalArgumentException</span></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalArgumentException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="createTempZip(java.lang.String,mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartFilterDto,java.util.Locale)">createTempZip</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">java.nio.file.Path</span>&nbsp;<span class="memberName">createTempZip</span>&#8203;(<span class="arguments">java.lang.String&nbsp;processedXml,
<a href="../entitiesDto/MultipartFilterDto.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto">MultipartFilterDto</a>&nbsp;multipartFilterDto,
java.util.Locale&nbsp;locale)</span>
                                  throws <span class="exceptions">java.io.IOException</span></div>
<div class="block">https://stackoverflow.com/a/43836969/11592202
 Relocates all the internal files from a given .kmz or .gpz from a User to the temp directory as a new kmz
 with replacing an old inner .kml or .gpx with the new one.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>processedXml</code> - A processed xml String to be written to the resulting file.</dd>
<dd><code>multipartFilterDto</code> - </dd>
<dd><code>locale</code> - To return a locale-oriented messages</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>Path</code> to a temp archive file with photos to be returned to a User.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - With the localized message to be returned to a User if the temp file writing is failed.</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="filterTempZip(java.lang.String,mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartFilterDto)">filterTempZip</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">filterTempZip</span>&#8203;(<span class="arguments">java.lang.String&nbsp;processedXml,
<a href="../entitiesDto/MultipartFilterDto.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto">MultipartFilterDto</a>&nbsp;multipartFilterDto)</span>
                    throws <span class="exceptions">java.io.IOException</span></div>
<div class="block">Extracts files from the user's archive, filters them and writes into a new temporary zip in the temp file.
 If no special encoding for filename given tries to use universal UTF8.
 When a <code>ZipInputStream</code> throws <code>MalformedInputException</code> or <code>IllegalArgumentException</code> it tries to
 change the filenames encoding in the <a href="#changeCharset(mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartFilterDto)"><code>changeCharset(MultipartFilterDto)</code></a> method.
 If no luck rethrows an <code>IllegalArgumentException</code> with the message to a user about filenames encoding info.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>processedXml</code> - </dd>
<dd><code>multipartFilterDto</code> - </dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - If something wrong while reading a zip archive.</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="changeCharset(mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartFilterDto)">changeCharset</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">changeCharset</span>&#8203;(<span class="arguments"><a href="../entitiesDto/MultipartFilterDto.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto">MultipartFilterDto</a>&nbsp;multipartFilterDto)</span></div>
<div class="block">If UTF8 filenames encoding has thrown an exception, this method
 For RU locale:
 1) Sets primary OEM "IBM866" encoding.
 2) Then tries to use "Windows-1251" encoding if no luck.
 3) Throws an exception with a message for a user if no luck.
 For EN locale:
 1) Sets primary "ISO-8859-1"
 2) Throws an exception with a message to a user if no luck.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>multipartFilterDto</code> - The inner parameter <a href="../entitiesDto/MultipartFilterDto.html#setCharset(java.nio.charset.Charset)"><code>MultipartFilterDto.setCharset(Charset)</code></a> has to be set
                           in the <a href="#filterTempZip(java.lang.String,mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartFilterDto)"><code>filterTempZip(String, MultipartFilterDto)</code></a> method.</dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="throwZipFilenamesEncodingException(mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartFilterDto)">throwZipFilenamesEncodingException</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">void</span>&nbsp;<span class="memberName">throwZipFilenamesEncodingException</span>&#8203;(<span class="arguments"><a href="../entitiesDto/MultipartFilterDto.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto">MultipartFilterDto</a>&nbsp;multipartFilterDto)</span></div>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getZipFilename(mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartFilterDto)">getZipFilename</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">java.lang.String</span>&nbsp;<span class="memberName">getZipFilename</span>&#8203;(<span class="arguments"><a href="../entitiesDto/MultipartFilterDto.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto">MultipartFilterDto</a>&nbsp;multipartFilterDto)</span></div>
<div class="block">As some old versions of Edge browser (at least Microsoft EdgeHTML 17 +) attach <code>MultipartFile.getOriginalFilename()</code>
 as the full path to the file (e.g. "C:\temp\Points.kmz" instead of just "Points.kmz"), getting just the filename
 is a bit more complicated.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>multipartFilterDto</code> - A filename to be extracted from.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The corrected filename of a .zip(.kmz) archive from a given <a href="../entitiesDto/MultipartMainDto.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto"><code>MultipartMainDto</code></a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="getXmlFromKmz(mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto.MultipartFilterDto,java.util.Locale)">getXmlFromKmz</a></h3>
<div class="memberSignature"><span class="modifiers">private</span>&nbsp;<span class="returnType">java.io.InputStream</span>&nbsp;<span class="memberName">getXmlFromKmz</span>&#8203;(<span class="arguments"><a href="../entitiesDto/MultipartFilterDto.html" title="class in mrbaxmypka.gmail.com.mapPointsTrimmer.entitiesDto">MultipartFilterDto</a>&nbsp;multipartFilterDto,
java.util.Locale&nbsp;locale)</span>
                                   throws <span class="exceptions">java.io.IOException</span></div>
<div class="block">1) Looks through all the .kmz
 2) Searches for .xml (.kml) file inside the given .zip (.kml) to return it in the end
 3) Adds all found images files to the instant cache in <code>MultipartMainDto#getImagesNamesFromZip()</code></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>multipartFilterDto</code> - Which contains .gpz, .kmz or any other ZIP archives</dd>
<dd><code>locale</code> - To send a localized error messages.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>InputStream</code> from the file with the given file extension (.kml as usual).</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.io.IOException</code> - If something wrong with the given .zip file</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
</div>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
</footer>
</div>
</div>
</body>
</html>
